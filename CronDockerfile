FROM alpine:latest
LABEL maintainer="Adam Brin"

#https://firefart.at/post/docker_and_cron_jobs/

ENV APP_USER appuser

RUN adduser -g "App User" -D $APP_USER

RUN apk add --update  --no-cache \
    postgresql  \
    mongodb-tools \
  && rm -rf /var/cache/apk/*

COPY docker/crontab /var/spool/cron/crontabs/$APP_USER
RUN chmod 0600 /var/spool/cron/crontabs/$APP_USER

ADD . /app
RUN echo "db:*:dataarc:dataarc:dataarc" > /root/.pgpass
RUN chmod 600 /root/.pgpass

ENTRYPOINT "crond"

CMD ["-f", "-d", "8"